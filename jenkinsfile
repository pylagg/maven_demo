pipeline{
	agent any
	tools{
	maven 'maven3.6'
	}
	    stages {
        	stage("Code Checkout") {
                     steps {
                	git branch: 'master',
                	url: 'https://github.com/pylagg/maven_demo.git'
                  }
              }
	      stage('Build Stage')
		{
			steps{
				bat 'mvn package'
			}
		}
		
		stage('Compile Stage')
		{
			steps{
				 bat 'mvn clean compile'
			}
		}
		stage('Testing Stage')
		{
			steps{
				 bat 'mvn test'
			}
		}
		                       
         	stage('build && SonarQube analysis') 
		{
            		steps {
                		withSonarQubeEnv('sonar') {
                                     		bat 'mvn clean package sonar:sonar'
                		}
            		}
        	}                      
         	stage('Email notification') 
		{
            		steps {
                		mail bcc: '',
				body: 'congratulation pipeline works', 
				cc: '', 
				from: '', 
				replyTo: '', 
				subject: 'pipeline', 
				to: 'pk1932ag@gmail.com'
		
                		}
            		
        	}
	}
}
